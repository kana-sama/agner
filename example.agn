log(Msg) -> agner:print({self(), Msg}).

printer() -> log(start), printer(1), log(finish).
printer(6) -> ok;
printer(N) -> log(N), printer(N+1).

main() ->
  log(main_start),
  repeat(5, fun spawn_printer/0),
  log(main_finish).

spawn_printer() -> spawn(fun printer/0).

repeat(0, F) -> ok;
repeat(N, F) -> F(), repeat(N-1, F).